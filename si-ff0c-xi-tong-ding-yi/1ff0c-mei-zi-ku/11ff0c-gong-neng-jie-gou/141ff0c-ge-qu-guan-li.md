# 歌曲媒体资源管理

主要处理自有曲库媒体文件即音频原伴唱，视频MV，打分歌词等各格式码率新旧文件的增删改查管理。

新系统支持在线批量转码，以及预览和设定各类规则文件。

### 歌曲资源标准数据与要求如下：

| 数据字段 | 使用示例与规格 | 所属对象 | 阶段 |
| :--- | :--- | :--- | :--- |
| 编码格式 | UTF-8，GB18030 | 字符集规范 | P1 |
| 防盗链验证 | Y/N | 白名单，域名/地区/平台/版本 | P2 |
| 原始创建时间 | 2017-04-15 01:15:43 |  | P1 |
| 最后更新时间 | 2017-05-15 01:15:46 |  | P1 |
| 最后缓存更新时间 | 2017-06-15 01:15:51 |  | P1 |
| 曲目编号 | T1234567890 | （唯一标识） | P1 |
| 原文件名 | S1234567890 | 合名（唯一性） | P1 |
| MD5 | 11AFAD2D3555EAB7F251A05C0B7915F9 | 散列函数（资源文件校验） | P2 |
| SHA1 | A48A9D261882A3AF795E4A9CECC47E8EA098EA7E | 数字签名（资源文件校验） | P2 |
| CRC32 | 5DB7252F | 循环冗余效验程序库（资源文件校验） | P2 |
| 文件类别编号 | 15，16 |  | P1 |
| 文件地址 | &lt;sousUrl&gt;Array | CDN-Url | P1 |

### 资源文件类型如下：

| 文件类别 | 类别编号 | 文件所属业务 | 平台 | 阶段 |
| :--- | :--- | :--- | :--- | :--- |
| 视频 | 14 | 手机无声MV | Phone |  |
|  | 17 | 手机原唱MV | Phone |  |
|  | 22 | 电视高清无声MV | TV |  |
|  | 25 | 电视标清无声MV | TV |  |
|  | 33 | 电视4K无声MV | TV |  |
|  | 34 | 在线K歌标清MV | TV |  |
|  | 35 | 在线K歌高清MV | TV |  |
|  | 36 | 在线K歌4KMV | TV |  |
|  |  |  |  |  |
| 音频 | 15 | 音频原唱 | Phone |  |
|  | 41 新 | 在线K歌原唱 | Phone | P1 |
|  | 16 | 音频伴奏 | Phone |  |
|  | 42 新 | 在线K歌伴奏 | Phone | P1 |
|  | 18 | 电视旧版音频原唱 | TV |  |
|  | 19 | 电视旧版音频伴奏 | TV |  |
|  |  |  |  |  |
| 歌词 | 20 | 歌词TRC | TV/Phone |  |
|  | 37 | 新版歌词LRC | TV/Phone |  |
|  |  |  |  |  |
| 打分 | 21 | 打分文件 | TV，Phone |  |
|  |  |  |  |  |

### 视频编解码格式要求如下：

| 类别编号 | 分辨率 | 帧数/s | 码率 | 码率模式 | 格式 | 编码器 | 规格 | 级别 | 容器 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 14 | 640\*480 | 25 | 450K | 2次 | H.264 | x264 | Main | 2.2 | MP4 |
| 17 | 640\*480 | 25 | 450K | 平均 | H.264 | x264 | Main | 2.2 | MP4 |
| 33 | 3840x2160 | 25 | 20000K | 平均 | H.264 | x.264 High5.1 |  |  | MP4 |
| 22 | 1920x1080 | 25 | 5000K | 平均 | H.264 | x.264 High4.0 |  |  | MP4 |
| 25 | 1280\*720 | 25 | 3000K | 平均 | H.264 | x.264 High4.0 |  |  | MP4 |
| 34 | 1280\*720 | 25 | 3000K | 平均 | H.264 | x.264 High4.0 | Main | 4.0 | MP4 |
| 35 | 1920x1080 | 25 | 5000K | 平均 | H.264 | x.264 High4.0 | High | 4.0 | MP4 |

### 音频编解码格式要求如下：

| 文件编号 | 音频 | 采样率 | 码率 | 码率模式 | 编码器 | 格式 | 声道 | 容器 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 15，16 |  | 44100Hz | 256K | VBR | Nero Encoder | LC-AAC | Stereo | MP4 |
| 41，42 新 |  | 44100Hz | 128K | VBR | Nero Encoder | LC-AAC | Stereo | MP4 |
| 17 | ID:0 | 44100Hz | 96K | VBR | Nero Encoder | LC-AAC | Stereo | MP4 |
| 18，19 |  | 44100Hz | 128K | CBR | LAME MP3 | MP3 | Stereo | MP3 |
| 34 | 双音轨 | 44100Hz | 128K | VBR | Nero Encoder | LC-AAC | Stereo | MP4 |
| 35 | 双音轨 | 44100Hz | 256K | VBR | Nero Encoder | LC-AAC | Stereo | MP4 |

### 用户上传视频编解码格式要求如下：

| 平台 | 分辨率 | 帧数/s | 码率 | 码率模式 | 格式 | 编码器 | 规格 | 级别 | 容器 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| Android | 640x480\(Max\) | 16 | 480K | 平均 | H.264 | x264 |  |  | MP4 |
| TV | 640x480\(Max\) | 16 | 480K | 平均 | H.264 | x264 |  |  | MP4 |
| iOS | 640x480\(Max\) | 16 | 480K | 平均 | H.264 | x264 |  |  | MP4 |

### 用户上传音频编解码格式要求如下：

| 平台 | 音频 | 采样率 | 码率 | 码率模式 | 编码器 | 格式 | 声道 | 容器 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| Android | 单音轨 | 44100Hz | 256K |  |  | LC-AAC | Stereo | MP4 |
| TV | 单音轨 | 44100Hz | 256K |  |  | LC-AAC | Stereo | MP4 |
| iOS | 单音轨 | 44100Hz | 256K |  |  | LC-AAC | Stereo | MP4 |

### 多资源文件分发与存储机制要求如下：

| 平台 | 业务类型 | 功能项 | 文件队列/编号 | 所属类别 | 阶段 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| TV | 在线K歌 | 分发 | 34/35/36，21 | 视频 双音轨，打分 |  |
|  |  | 保存 | 伴唱 + 干音 |  |  |
|  | 离线K歌 | 分发 | 22/25/33，18，19，20，21 | 视频，原唱，伴唱，歌词，打分 |  |
|  |  | 保存-音频 | 19 + 干音 | 伴唱，录音 |  |
|  |  | 保存-MV | 22/25/24 + 19 + 混音，干音 | 视频，伴唱，录音 |  |
|  |  | 保存-自拍 | 自拍 + 19 + 混音，干音 | 录像，伴唱，录音 |  |
| Phone | 离线唱 | 分发 | 14，15，16，20，21 | 视频，原唱，伴唱，歌词，打分 |  |
|  |  | 保存-音频 | 16 + 干音 | 伴唱，录音 |  |
|  |  | 保存-MV | 14 + 16 + 混音，干音 | 视频，伴唱，录音 |  |
|  |  | 保存-自拍 | 自拍 + 16 + 混音，干音 | 录像，伴唱，录音 |  |
|  | 在线唱 | 分发 | 14，41，42，20，21 | 视频，原唱，伴唱，歌词，打分 |  |
|  |  | 保存-音频 | 42 + 干音 | 伴唱，录音 |  |
|  |  | 保存-MV | 14 + 42 + 混音，干音 | 视频，伴唱，录音 |  |
|  |  | 保存-自拍 | 自拍 + 16 + 混音，干音 | 录像，伴唱，录音 | P2 |
|  | 合唱 | 分发1th | 14，15，16，20，21 | 视频，原唱，伴唱，歌词，打分 |  |
|  |  | 保存1th | 16 + 混音，干音 | 伴唱，录音 |  |
|  |  |  | 14 + 16 + 混音，干音 | 视频，伴唱，录音 |  |
|  |  | 分发2th | &lt;用户作品&gt; |  |  |
|  |  | 保存2th | &lt;自拍MV&gt; |  |  |
|  |  | 保存2th | &lt;保持原有不变&gt; |  |  |
|  |  |  |  |  |  |

### 主要的的管理项和实施目标如下：

| 从属业务 | 业务项 | 功能项 | 实施 | 阶段 |
| :--- | :--- | :--- | :--- | :--- |
| 添加文件 | 添加文件类别 | 通过在线输入文件类别和平台加入类别 | 由曲库管理员手动处理 | P1 |
|  | 添加文件 | 通过后台增量扫描读取已转码新曲目入库 | 由曲库管理员自动批处理信息导入 | P2 |
|  |  | 通过在线配置音视频编解码属性自动转码生成 | 由曲库管理员手动和批处理 | P3 |
| 替换文件 | 替换文件 | 通过查找指定文件地址手动替换新文件 | 由曲库管理员手动处理 | P1 |
| 查询地址 | 查看歌曲文件地址 | 管理员以曲目字段组合查询结果中查看文件地址列表 | 由曲库管理员手动处理 | P1 |
| 资源预览 | 预览文件 | 通过在线查看各类曲目媒体或文本资源文件检查正确性 | 由曲库管理员手动处理 | P1 |
| 资源校验 | 文件验证 | 通过比对对文件身份码以及抽取画面帧校验资源文件完整性 | 由曲库管理员自动批处理 | P2 |
| 资源缺失 | 自动报表 | 通过比对文件地址进行定时扫描检测URL可用性生成并发送报表 | 由曲库管理员自动接收处理 | P2 |
| 资源反馈 | 缺失歌曲申报 | 通过客户端反馈无检索结果曲目手动上报 | 由曲库管理员查看处理反馈列表 | P2 |
|  | 资源错误 | 通过客户端选择反馈资源文件类型错误 | 由曲库管理员查看并确认处理反馈列表 | P2 |
|  | 歌词错误 | 通过客户端选择编辑歌词错误提交上传 | 由曲库管理员查看并确认处理反馈列表 | P2 |



